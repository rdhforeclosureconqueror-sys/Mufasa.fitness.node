<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pan-African Virtual Wellness Platform</title>

<!-- Google Sign-In -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<!-- existing TF + pose libs etc -->
<!-- ... keep your same script imports here ... -->

<style>
/* keep all your existing CSS here (unchanged) */

/* --- LOGIN OVERLAY --- */
#loginOverlay {
  position: fixed;
  inset: 0;
  backdrop-filter: blur(8px) brightness(0.4);
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  flex-direction: column;
  transition: opacity 0.6s ease;
}
#loginOverlay.hidden { opacity: 0; pointer-events: none; }

#loginBox {
  background: radial-gradient(circle at top, #111, #000);
  border: 2px solid #facc15;
  border-radius: 20px;
  padding: 40px 50px;
  text-align: center;
  box-shadow: 0 0 40px rgba(250,204,21,0.4);
  color: #facc15;
  max-width: 320px;
}
#loginBox h1 {
  color: #facc15;
  font-size: 1.4rem;
  margin-bottom: 10px;
}
#googleBtn {
  margin-top: 20px;
  background: linear-gradient(90deg,#ef4444,#22c55e);
  color: #fff;
  border: 2px solid #facc15;
  border-radius: 999px;
  padding: 10px 18px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .15s ease, box-shadow .3s ease;
}
#googleBtn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #facc15;
}
#userInfo {
  position: fixed;
  top: 10px;
  right: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 2000;
}
#userInfo img {
  width: 36px; height: 36px; border-radius: 50%;
  border: 2px solid #facc15;
}
#signOutBtn {
  background: #ef4444;
  border: none;
  border-radius: 999px;
  color: #fff;
  padding: 4px 10px;
  font-size: .75rem;
  cursor: pointer;
}
#signOutBtn:hover { background: #b91c1c; }
</style>
</head>

<body>
  <!-- === LOGIN OVERLAY === -->
  <div id="loginOverlay">
    <div id="loginBox">
      <h1>Enter the Mufasa Realm ðŸ”¥</h1>
      <p style="font-size:0.9rem;color:#fde68a;">
        Sign in with your Google account to unlock your Pan-African dashboard.
      </p>
      <button id="googleBtn">Enter the Mufasa Realm ðŸ”¥ (Google Login)</button>
    </div>
  </div>

  <!-- user info -->
  <div id="userInfo" style="display:none;">
    <img id="userPic" src="" alt="profile"/>
    <span id="userName" style="color:#facc15;font-weight:600;"></span>
    <button id="signOutBtn">Sign out</button>
  </div>

  <!-- === ORIGINAL APP START === -->
  <div class="app">
    <!-- keep your entire existing dashboard markup exactly as before -->
    <!-- ... (your full app code remains unchanged) ... -->
  </div>

<script>
/* === GOOGLE LOGIN LOGIC === */
const CLIENT_ID = "1053883905933-n4a6ll6m7l3lqd60mq3g2rnb6iktdgp2.apps.googleusercontent.com";
const VERIFY_URL = "https://mufasa-fitness-node.onrender.com/verify-google-token";

const overlay = document.getElementById("loginOverlay");
const googleBtn = document.getElementById("googleBtn");
const userInfo = document.getElementById("userInfo");
const userPic = document.getElementById("userPic");
const userName = document.getElementById("userName");
const signOutBtn = document.getElementById("signOutBtn");

async function verifyToken(id_token){
  try{
    const res = await fetch(VERIFY_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ token:id_token })
    });
    const data = await res.json();
    return data;
  }catch(e){
    console.error("verify error",e);
    return null;
  }
}

function showOverlay(show){
  if(show){
    overlay.classList.remove("hidden");
  }else{
    overlay.classList.add("hidden");
  }
}

googleBtn.onclick = async ()=>{
  google.accounts.id.initialize({
    client_id: CLIENT_ID,
    callback: async (response)=>{
      const id_token = response.credential || null;
      if(!id_token) return;
      const verified = await verifyToken(id_token);
      if(verified && verified.ok){
        const u = verified.user || {};
        userPic.src = u.picture || "https://i.imgur.com/9z3s8Gh.png";
        userName.textContent = u.name || u.email || "User";
        userInfo.style.display="flex";
        showOverlay(false);
      }else{
        alert("Login failed. Please try again.");
      }
    }
  });
  google.accounts.id.prompt(); // show Google popup
};

signOutBtn.onclick = ()=>{
  userInfo.style.display="none";
  showOverlay(true);
  google.accounts.id.disableAutoSelect();
};
</script>

<!-- keep your existing large <script> block with Maâ€™at logic here unchanged -->

</body>
</html>
